class Terrain {
  
  //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  
  boolean RunnedSetup = false;
  
  ArrayList<ArrayList<Chunk>> TerrainChunks = new ArrayList<ArrayList<Chunk>>();
  float[] TerPos = new float[7];
  PImage Map;
  
  //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  
  Terrain(float PX, float PY, float PZ, float PW, float PH, PImage ChunkMap) {
    TerPos[0] = PX;
    TerPos[1] = PY;
    TerPos[2] = PZ;
    TerPos[3] = PW;
    TerPos[4] = PH;
    TerPos[5] = ChunkMap.width;
    TerPos[6] = ChunkMap.height;
    Map = ChunkMap;
    
  }
  
  //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  
  void Setup() {
    TerrainSetup();
    
    RunnedSetup = true;
    
  }
  
  //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  
  void Draw()
  {
    if (!RunnedSetup)
      Setup();
      
    RenderTerrain();
    
  }
  
  //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

  void TerrainSetup()
  {
    float W = TerPos[3]/Map.width;
    float L = TerPos[4]/Map.height;
    for (int Lpx1 = 0; Lpx1 < Map.width; Lpx1++)
    {
      //Add a slice of chunks into a arraylist
      ArrayList<Chunk> ColChunkSlc = new ArrayList<Chunk>();
      for (int Lpy1 = 0; Lpy1 < Map.height; Lpy1++) 
        ColChunkSlc.add(new Chunk(TerPos[0] +W *Lpx1, TerPos[1], TerPos[2] +L *Lpy1, W, (red(Map.get(Lpx1, Lpy1)) +green(Map.get(Lpx1, Lpy1)) +blue(Map.get(Lpx1, Lpy1)))/3, L, Map.get(Lpx1, Lpy1)));
      
      //Add that slice into the rows of the arraylist
      TerrainChunks.add(ColChunkSlc);
    }
  }
  
  //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  
  void RenderTerrain()
  {
    for (int Lp1 = 0; Lp1 < TerrainChunks.size(); Lp1++)
      for (int Lp2 = 0; Lp2 < TerrainChunks.get(0).size(); Lp2++)
        TerrainChunks.get(Lp1).get(Lp2).Draw();
  }
  
  //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  
}
